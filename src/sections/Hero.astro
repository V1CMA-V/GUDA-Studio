---
import Button from '@/components/Button.astro'

const whatsApp = 2441375131

const message = encodeURIComponent(
  '¡Hola! Estoy interesado en reservar una clase en GUDAS Studio. ¿Podrían ayudarme con la información?'
)

const handleWhatsAppClick = () => {
  const url = `https://wa.me/${whatsApp}?text=${message}`
  return url
}
---

<div class="relative w-full h-[90vh] sm:h-screen max-w-dvw md:aspect-video">
  <div
    class="absolute inset-0 h-full w-full flex flex-col items-center justify-center z-10 m-auto px-4 sm:px-6"
  >
    <section
      id="hero-section"
      class="flex flex-col items-center gap-20 sm:gap-6 md:gap-8 w-full max-w-4xl mx-auto"
    >
      <h1
        class="flex flex-col items-center gap-2 sm:gap-3 md:gap-5 lg:gap-6 text-7xl md:text-9xl font-bold tracking-wider"
      >
        <span class="text-primary text-center">GUDAS</span>
        <span
          class="cursive text-5xl md:text-6xl lg:text-7xl font-normal text-white relative -mt-9 md:-mt-6 lg:-mt-18"
        >
          Studio
        </span>
      </h1>

      <p
        class="text-white/90 text-lg sm:text-xl lg:text-2xl text-center px-2 sm:px-4 max-w-2xl leading-relaxed"
      >
        Donde la pasión cobra vida a través del movimiento
      </p>
      <div id="button-hero" class="mt-2 sm:mt-4">
        <Button
          href={handleWhatsAppClick()}
          className="w-full max-w-xs sm:max-w-sm"
        >
          Reserva tu clase ahora!
        </Button>
      </div>
    </section>
  </div>

  <div class="absolute inset-0 bg-black/50 z-0"></div>

  <video
    autoplay
    muted
    loop
    playsinline
    id="hero-video"
    preload="auto"
    class="absolute h-full w-full object-cover object-center -z-10"
  >
    <source src="/videos/hero.mp4" type="video/mp4" />
    Tu navegador no soporta el video HTML5.
  </video>

  <video
    autoplay
    muted
    loop
    playsinline
    id="hero-video"
    preload="auto"
    class="absolute h-full w-full object-cover object-center -z-20 blur-2xl top-10"
  >
    <source src="/videos/hero.mp4" type="video/mp4" />
    Tu navegador no soporta el video HTML5.
  </video>
</div>

<script>
  import gsap from 'gsap'
  import { SplitText } from 'gsap/SplitText'

  gsap.registerPlugin(SplitText)

  const mainTitle = document.querySelector('#hero-section h1')
  const mainTitleSplit = new SplitText(mainTitle, {
    type: 'chars',
  })

  // Ajustar animaciones para móviles
  const mm = gsap.matchMedia()

  mm.add(
    {
      isMobile: '(max-width: 639px)',
      isTablet: '(min-width: 640px) and (max-width: 1023px)',
      isDesktop: '(min-width: 1024px)',
    },
    (context) => {
      const { isMobile } = context.conditions

      // Animación del título principal
      gsap.from(mainTitleSplit.chars, {
        duration: 1,
        y: isMobile ? 30 : 50,
        stagger: 0.2,
        autoAlpha: 0,
        filter: 'blur(8px)',
        ease: 'power4.out',
        delay: isMobile ? 0.5 : 1,
      })

      // Animación del párrafo
      const paragraph = document.querySelector('#hero-section p')
      const paragraphSplit = new SplitText(paragraph, {
        type: 'words',
        wordsClass: 'word',
      })

      gsap.from(paragraphSplit.words, {
        duration: isMobile ? 0.8 : 1.2,
        y: isMobile ? 20 : 30,
        autoAlpha: 0,
        stagger: 0.1,
        filter: 'blur(8px)',
        ease: 'power4.out',
        delay: isMobile ? 0.8 : 1.2,
      })

      // Animación del botón
      const button = document.querySelector('#hero-section #button-hero')
      gsap.from(button, {
        duration: isMobile ? 0.8 : 1,
        y: 30,
        autoAlpha: 0,
        ease: 'power4.out',
        delay: isMobile ? 1.2 : 1.5,
      })
    }
  )
</script>
